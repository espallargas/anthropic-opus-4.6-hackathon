/* eslint-disable react-refresh/only-export-components */
import { createContext, useContext, useState, useCallback, useEffect, type ReactNode } from 'react';

export type Locale = 'pt-BR' | 'en' | 'ar';
export type Direction = 'ltr' | 'rtl';

const LOCALE_DIRECTION: Record<Locale, Direction> = {
  'pt-BR': 'ltr',
  en: 'ltr',
  ar: 'rtl',
};

interface I18nContextValue {
  locale: Locale;
  direction: Direction;
  setLocale: (locale: Locale) => void;
  t: (key: string) => string;
}

const STORAGE_KEY = 'app_locale';

const dictionaries: Record<Locale, Record<string, string>> = {
  'pt-BR': {
    'app.title': 'FreePath',
    'nav.chat': 'Chat',
    'nav.admin': 'Admin',
    'nav.menu': 'Menu',
    'nav.logo.alt': 'Logo FreePath',
    'resize.tooltip': 'Arraste para redimensionar',
    'sidebar.reconfigure': 'Reconfigurar',
    'sidebar.reconfigure.tooltip': 'Reconfigurar dados',
    'sidebar.expand': 'Expandir',
    'sidebar.collapse': 'Colapsar',
    'sidebar.language': 'Idioma',
    'chat.empty': 'Envie uma mensagem para começar.',
    'chat.placeholder': 'Digite sua mensagem...',
    'chat.stop': 'Parar (Esc)',
    'chat.send': 'Enviar',
    'chat.processing': 'Processando...',
    'chat.copy': 'Copiar',
    'chat.copied': 'Copiado!',
    'chat.interrupted': '*[resposta interrompida]*',
    'chat.faq.visaOptions': 'Opções de visto',
    'chat.faq.visaOptions.prompt':
      'Gostaria de saber quais são as opções de visto disponíveis para o meu tipo de migração.',
    'chat.faq.requiredDocs': 'Documentos necessários',
    'chat.faq.requiredDocs.prompt':
      'Quais são os documentos necessários para dar entrada no processo migratório?',
    'chat.faq.timeline': 'Prazos e custos',
    'chat.faq.timeline.prompt':
      'Qual é o prazo estimado e os custos envolvidos no processo migratório?',
    'chat.faq.gettingStarted': 'Por onde começar?',
    'chat.faq.gettingStarted.prompt':
      'Por onde eu começo? Qual é o primeiro passo para iniciar meu processo migratório?',
    'greeting.intro': 'Olá! Entendi que você possui as seguintes informações:',
    'greeting.nationalities': 'Nacionalidades',
    'greeting.origin': 'País de origem',
    'greeting.destination': 'País de destino',
    'greeting.objective': 'Objetivo',
    'greeting.closing': 'Como posso te ajudar hoje?',
    'setup.description':
      'Preencha seus dados para receber orientações personalizadas sobre seu processo de imigração.',
    'setup.origin': 'País de origem',
    'setup.origin.placeholder': 'Selecione seu país de origem',
    'setup.nationality': 'Nacionalidade',
    'setup.nationality.placeholder': 'Ex: Brasileira',
    'setup.destination': 'País de destino',
    'setup.destination.placeholder': 'Selecione seu país de destino',
    'setup.visa': 'Tipo de visto / objetivo',
    'setup.visa.placeholder': 'Ex: Trabalho, estudo, residência permanente',
    'setup.additional': 'Informações adicionais (opcional)',
    'setup.additional.placeholder': 'Contexto adicional que possa ajudar nas respostas...',
    'setup.submit': 'Iniciar chat',
    'setup.step.origin': 'País de origem',
    'setup.step.origin.description': 'De qual país você estará saindo?',
    'setup.step.nationalities': 'Nacionalidades',
    'setup.step.nationalities.description': 'Liste todas as suas nacionalidades atuais',
    'setup.step.destination': 'País de destino',
    'setup.step.objective': 'Objetivo',
    'setup.step.objective.description': 'Qual é o seu motivo de ida para o país de destino?',
    'setup.objective.temporary_visit': 'Visita temporária',
    'setup.objective.education': 'Educação',
    'setup.objective.work': 'Trabalho',
    'setup.objective.family_reunion': 'Reunir família',
    'setup.objective.seek_protection': 'Buscar proteção',
    'setup.objective.investments': 'Investimentos',
    'setup.objective.permanent_residence': 'Residência permanente',
    'setup.objective.other': 'Outro',
    'setup.objective.other.placeholder': 'Descreva seu objetivo...',
    'setup.next': 'Próximo',
    'setup.back': 'Voltar',
    'setup.cancel': 'Cancelar',
    'setup.start': 'Iniciar chat',
    'setup.search.placeholder': 'Buscar país...',
    'chat.context.nationalities': 'Nacionalidades:',
    'chat.context.from': 'De',
    'chat.context.to': 'Para',
    'tool.search_visa_requirements': 'Buscando requisitos de visto',
    'tool.check_processing_times': 'Consultando prazos de processamento',
    'tool.analyze_pathways': 'Analisando rotas de imigração',
    'tool.check_eligibility': 'Verificando elegibilidade',
    'tool.list_required_documents': 'Listando documentos necessários',
    'tool.get_processing_statistics': 'Obtendo estatísticas de processamento',
    'tool.code_execution': 'Executando código',
    'tool.get_legislation': 'Buscando legislação',
    'usage.input': 'Entrada',
    'usage.output': 'Saída',
    'usage.cached': 'em cache',
    'usage.cache_miss': 'cache miss',
    'sidebar.newChat': 'Novo chat',
    'sidebar.deleteChat': 'Excluir chat',
    'globe.loading': 'Carregando globo...',
    'agent.analyze_pathways': 'Estrategista de Percurso',
    'agent.check_eligibility': 'Analista de Elegibilidade',
    'agent.list_required_documents': 'Especialista em Documentação',
    'agent.get_processing_statistics': 'Gerente de Aplicação',
    'agent.unknown': 'Agente',
    'agent.analyzing': 'Analisando...',
    'agent.cancelled': 'Cancelado',
    'usage.label': 'Tokens utilizados',
    'thinking.active': 'Pensando...',
    'thinking.done': 'Raciocínio concluído',
    'admin.header.title': 'Legislação Admin',
    'admin.header.description': 'Gerenciar legislação por país',
    'admin.section.active': 'Ativo',
    'admin.section.pending': 'Pendente',
    'admin.country_item.updated': 'atualizado',
    'admin.country_item.view_legislations': 'Ver legislações',
    'admin.country_item.refresh_legislation': 'Atualizar legislação',
    'admin.units.doc': 'doc',
    'admin.units.docs': 'docs',
    'admin.units.tokens': 'tokens',
    'admin.units.legislation': 'legislação',
    'admin.units.legislations': 'legislações',
    'admin.crawl.loading': 'Carregando...',
    'admin.crawl.error': 'Erro ao carregar países',
    'admin.crawl.retry': 'Tentar novamente',
    'admin.crawl.no_countries': 'Nenhum país disponível',
    'admin.crawl.pause': 'Pausar rastreamento',
    'admin.crawl.close': 'Fechar',
    'admin.crawl.starting': 'Iniciando rastreamento...',
    'admin.crawl.complete': '✓ Rastreamento completo',
    'admin.crawl.documents_saved': 'documentos salvos',
    'admin.crawl.stop_confirm': 'Parar rastreamento?',
    'admin.crawl.stop_description':
      'O progresso será descartado. Todos os dados são salvos apenas no final.',
    'admin.crawl.stop_cancel': 'Cancelar',
    'admin.crawl.stop_confirm_button': 'Parar e Fechar',
    'admin.categories.title': 'Categorias',
    'admin.categories.searching': 'Pesquisando...',
    'admin.categories.results_crawled': 'resultados web rastreados',
    'admin.categories.parsed': 'legislações analisadas',
    'admin.thinking.title': 'Pensando',
    'admin.thinking.waiting': 'Aguardando Claude pensar...',
    'admin.thinking.tokens': 'Tokens:',
    'admin.output.title': 'Saída do Claude',
    'admin.output.waiting': 'Aguardando saída do Claude...',
    'admin.legislation_panel.loading': 'Carregando...',
    'admin.legislation_panel.empty': 'Sem legislações',
    'admin.category.federal_laws': 'Leis Federais',
    'admin.category.federal_laws.description': 'Leis constitucionais & principais',
    'admin.category.regulations': 'Regulamentos',
    'admin.category.regulations.description': 'Procedimentos oficiais',
    'admin.category.consular': 'Regras Consulares',
    'admin.category.consular.description': 'Visto & embaixadas',
    'admin.category.jurisdictional': 'Jurisdicional',
    'admin.category.jurisdictional.description': 'Regras regionais',
    'admin.category.complementary': 'Saúde & Complementar',
    'admin.category.complementary.description': 'Requisitos de saúde',
    'admin.category.auxiliary': 'Auxiliar',
    'admin.category.auxiliary.description': 'Estatísticas & quotas',
    'admin.crawl.tokens': 'tokens',
    'admin.crawl.parsing': 'analisando',
    'admin.crawl.found': 'encontrado',
    'admin.crawl.searching': 'Procurando',
    'admin.crawl.documents_indexed': 'documentos indexados',
    'admin.thinking.adaptive': 'Adaptativo',
    'admin.thinking.high_effort': 'Alto esforço',
    'admin.crawl.more': 'mais',
    'admin.extraction.progress': 'extraído',
    'admin.extraction.processing': 'extraindo...',
    'admin.extraction.failed': 'falhou',
    'legislation.source': 'Fonte',
    'legislation.deprecated': 'Descontinuada',
    'usage.tokens_short': 'tokens',
    'countries.us': 'Estados Unidos',
    'countries.br': 'Brasil',
    'countries.de': 'Alemanha',
    'countries.fr': 'França',
    'countries.gb': 'Reino Unido',
    'countries.ca': 'Canadá',
    'countries.au': 'Austrália',
    'countries.jp': 'Japão',
    'countries.cn': 'China',
    'countries.in': 'Índia',
    'countries.mx': 'México',
    'countries.es': 'Espanha',
    'countries.it': 'Itália',
    'countries.nl': 'Holanda',
    'countries.se': 'Suécia',
    'countries.ch': 'Suíça',
    'countries.at': 'Áustria',
    'countries.be': 'Bélgica',
    'countries.gr': 'Grécia',
    'countries.pt': 'Portugal',
    'countries.nz': 'Nova Zelândia',
    'countries.sg': 'Singapura',
    'countries.hk': 'Hong Kong',
    'countries.kr': 'Coreia do Sul',
    'countries.th': 'Tailândia',
    'countries.ph': 'Filipinas',
    'countries.my': 'Malásia',
    'countries.id': 'Indonésia',
    'countries.vn': 'Vietnã',
    'countries.ar': 'Argentina',
    'countries.cl': 'Chile',
    'countries.co': 'Colômbia',
    'countries.pe': 'Peru',
    'countries.za': 'África do Sul',
    'countries.eg': 'Egito',
    'countries.ng': 'Nigéria',
    'countries.ke': 'Quênia',
    'countries.ae': 'Emirados Árabes Unidos',
    'countries.sa': 'Arábia Saudita',
    'countries.il': 'Israel',
    'countries.tr': 'Turquia',
    'countries.ru': 'Rússia',
    'countries.ua': 'Ucrânia',
    'countries.pl': 'Polônia',
    'countries.cz': 'República Tcheca',
    'countries.hu': 'Hungria',
    'countries.ro': 'Romênia',
    'countries.bg': 'Bulgária',
    'countries.hr': 'Croácia',
    'countries.ie': 'Irlanda',
    'countries.dk': 'Dinamarca',
    'countries.fi': 'Finlândia',
    'countries.no': 'Noruega',
    'countries.is': 'Islândia',
    'countries.lv': 'Letônia',
    'countries.lt': 'Lituânia',
    'countries.ee': 'Estônia',
    'countries.sk': 'Eslováquia',
    'countries.si': 'Eslovênia',
    'countries.mt': 'Malta',
    'countries.cy': 'Chipre',
    'countries.lu': 'Luxemburgo',
    'countries.kz': 'Cazaquistão',
    'countries.ge': 'Geórgia',
    'countries.az': 'Azerbaijão',
    'countries.am': 'Armênia',
    'countries.pk': 'Paquistão',
    'countries.bd': 'Bangladesh',
    'countries.lk': 'Sri Lanka',
    'countries.np': 'Nepal',
    'countries.kh': 'Camboja',
    'countries.la': 'Laos',
    'countries.mm': 'Mianmar',
    'countries.tw': 'Taiwan',
    'countries.mz': 'Moçambique',
    'countries.tz': 'Tanzânia',
    'countries.ug': 'Uganda',
    'countries.gh': 'Gana',
    'countries.sn': 'Senegal',
    'countries.ci': 'Costa do Marfim',
    'countries.tn': 'Tunísia',
    'countries.dz': 'Argélia',
    'countries.ma': 'Marrocos',
    'countries.jo': 'Jordânia',
    'countries.lb': 'Líbano',
    'countries.kw': 'Kuwait',
    'countries.qa': 'Catar',
    'countries.bh': 'Bahrein',
    'countries.om': 'Omã',
    'countries.ye': 'Iêmen',
    'countries.ir': 'Irã',
    'countries.af': 'Afeganistão',
    'countries.iq': 'Iraque',
    'countries.sy': 'Síria',
    'countries.ve': 'Venezuela',
    'countries.ec': 'Equador',
    'countries.bo': 'Bolívia',
    'countries.py': 'Paraguai',
    'countries.uy': 'Uruguai',
    'countries.cr': 'Costa Rica',
    'countries.pa': 'Panamá',
    'countries.do': 'República Dominicana',
    'countries.cu': 'Cuba',
    'countries.jm': 'Jamaica',
    'countries.tt': 'Trinidad e Tobago',
    'countries.bb': 'Barbados',
    'countries.gy': 'Guiana',
    'countries.sr': 'Surinã',
    'countries.bz': 'Belize',
    'countries.sv': 'El Salvador',
    'countries.gt': 'Guatemala',
    'countries.hn': 'Honduras',
    'countries.ni': 'Nicarágua',
    'countries.fj': 'Fiji',
    'theme.label': 'Tema',
    'theme.mood.clean': 'Limpo',
    'theme.mood.tech': 'Tech',
    'theme.mood.warm': 'Quente',
    'theme.mood.bold': 'Ousado',
    'theme.midnight': 'Midnight',
    'theme.slate': 'Slate',
    'theme.slate_rose': 'Slate Rose',
    'theme.slate_emerald': 'Slate Emerald',
    'theme.slate_gold': 'Slate Gold',
    'theme.obsidian': 'Obsidian',
    'theme.aurora': 'Aurora',
    'theme.nebula': 'Nebula',
    'theme.neon': 'Neon',
    'theme.ember': 'Ember',
    'theme.sage': 'Sage',
    'theme.copper': 'Copper',
    'theme.cosmos': 'Cosmos',
    'theme.arctic': 'Arctic',
    'theme.horizon': 'Horizon',
    'nav.design': 'Design',
    'design.title': 'Design System',
    'design.subtitle': 'Referência visual de componentes com o tema ativo',
    'design.section.palette': 'Paleta de Cores',
    'design.section.typography': 'Tipografia',
    'design.section.buttons': 'Botões',
    'design.section.inputs': 'Campos de Entrada',
    'design.section.cards': 'Cards',
    'design.section.status': 'Indicadores de Status',
    'design.section.glass': 'Glass Panel',
    'design.section.expandable': 'Seções Expansíveis',
    'design.section.icon_buttons': 'Botões de Ícone',
    'design.section.section_header': 'Section Header',
    'design.section.agents': 'Agent Cards',
    'design.section.thinking': 'Thinking Cards',
    'design.section.tools': 'Tool Call Cards',
    'design.section.usage': 'Badge de Uso',
    'design.section.animations': 'Animações',
  },
  en: {
    'app.title': 'FreePath',
    'nav.chat': 'Chat',
    'nav.admin': 'Admin',
    'nav.menu': 'Menu',
    'nav.logo.alt': 'FreePath Logo',
    'resize.tooltip': 'Drag to resize',
    'sidebar.reconfigure': 'Reconfigure',
    'sidebar.reconfigure.tooltip': 'Reconfigure data',
    'sidebar.expand': 'Expand',
    'sidebar.collapse': 'Collapse',
    'sidebar.language': 'Language',
    'chat.empty': 'Send a message to get started.',
    'chat.placeholder': 'Type your message...',
    'chat.stop': 'Stop (Esc)',
    'chat.send': 'Send',
    'chat.processing': 'Processing...',
    'chat.copy': 'Copy',
    'chat.copied': 'Copied!',
    'chat.interrupted': '*[response interrupted]*',
    'chat.faq.visaOptions': 'Visa options',
    'chat.faq.visaOptions.prompt':
      "I'd like to know what visa options are available for my type of migration.",
    'chat.faq.requiredDocs': 'Required documents',
    'chat.faq.requiredDocs.prompt': 'What documents do I need to start the immigration process?',
    'chat.faq.timeline': 'Timeline & costs',
    'chat.faq.timeline.prompt':
      'What are the estimated timelines and costs involved in the immigration process?',
    'chat.faq.gettingStarted': 'Where to start?',
    'chat.faq.gettingStarted.prompt':
      'Where do I start? What is the first step to begin my immigration process?',
    'greeting.intro': 'Hello! I understand you have the following details:',
    'greeting.nationalities': 'Nationalities',
    'greeting.origin': 'Origin country',
    'greeting.destination': 'Destination country',
    'greeting.objective': 'Objective',
    'greeting.closing': 'How can I help you today?',
    'setup.description':
      'Fill in your details to receive personalized guidance on your immigration process.',
    'setup.origin': 'Country of origin',
    'setup.origin.placeholder': 'Select your country of origin',
    'setup.nationality': 'Nationality',
    'setup.nationality.placeholder': 'Ex: Brazilian',
    'setup.destination': 'Destination country',
    'setup.destination.placeholder': 'Select your destination country',
    'setup.visa': 'Visa type / objective',
    'setup.visa.placeholder': 'Ex: Work, study, permanent residence',
    'setup.additional': 'Additional information (optional)',
    'setup.additional.placeholder': 'Additional context that may help...',
    'setup.submit': 'Start chat',
    'setup.step.origin': 'Country of origin',
    'setup.step.origin.description': 'Which country will you be departing from?',
    'setup.step.nationalities': 'Nationalities',
    'setup.step.nationalities.description': 'List all your current nationalities',
    'setup.step.destination': 'Destination country',
    'setup.step.objective': 'Objective',
    'setup.step.objective.description': 'What is your reason for going to the destination country?',
    'setup.objective.temporary_visit': 'Temporary visit',
    'setup.objective.education': 'Education',
    'setup.objective.work': 'Work',
    'setup.objective.family_reunion': 'Family reunion',
    'setup.objective.seek_protection': 'Seek protection',
    'setup.objective.investments': 'Investments',
    'setup.objective.permanent_residence': 'Permanent residence',
    'setup.objective.other': 'Other',
    'setup.objective.other.placeholder': 'Describe your objective...',
    'setup.next': 'Next',
    'setup.back': 'Back',
    'setup.cancel': 'Cancel',
    'setup.start': 'Start chat',
    'setup.search.placeholder': 'Search country...',
    'chat.context.nationalities': 'Nationalities:',
    'chat.context.from': 'From',
    'chat.context.to': 'To',
    'tool.search_visa_requirements': 'Searching visa requirements',
    'tool.check_processing_times': 'Checking processing times',
    'tool.analyze_pathways': 'Analyzing immigration pathways',
    'tool.check_eligibility': 'Checking eligibility',
    'tool.list_required_documents': 'Listing required documents',
    'tool.get_processing_statistics': 'Getting processing statistics',
    'tool.code_execution': 'Executing code',
    'tool.get_legislation': 'Fetching legislation',
    'usage.input': 'Input',
    'usage.output': 'Output',
    'usage.cached': 'cached',
    'usage.cache_miss': 'cache miss',
    'sidebar.newChat': 'New chat',
    'sidebar.deleteChat': 'Delete chat',
    'globe.loading': 'Loading globe...',
    'agent.analyze_pathways': 'Pathway Strategist',
    'agent.check_eligibility': 'Eligibility Analyst',
    'agent.list_required_documents': 'Documentation Specialist',
    'agent.get_processing_statistics': 'Application Manager',
    'agent.unknown': 'Agent',
    'agent.analyzing': 'Analyzing...',
    'agent.cancelled': 'Cancelled',
    'thinking.active': 'Thinking...',
    'thinking.done': 'Reasoning complete',
    'usage.label': 'Tokens used',
    'admin.header.title': 'Legislation Admin',
    'admin.header.description': 'Manage country legislation',
    'admin.section.active': 'Active',
    'admin.section.pending': 'Pending',
    'admin.country_item.updated': 'updated',
    'admin.country_item.view_legislations': 'View legislations',
    'admin.country_item.refresh_legislation': 'Refresh legislation',
    'admin.units.doc': 'doc',
    'admin.units.docs': 'docs',
    'admin.units.tokens': 'tokens',
    'admin.units.legislation': 'legislation',
    'admin.units.legislations': 'legislations',
    'admin.crawl.loading': 'Loading...',
    'admin.crawl.error': 'Error loading countries',
    'admin.crawl.retry': 'Retry',
    'admin.crawl.no_countries': 'No countries available',
    'admin.crawl.pause': 'Pause crawl',
    'admin.crawl.close': 'Close',
    'admin.crawl.starting': 'Starting crawl...',
    'admin.crawl.complete': '✓ Crawl complete',
    'admin.crawl.documents_saved': 'documents saved',
    'admin.crawl.searching': 'Searching',
    'admin.crawl.documents_indexed': 'documents indexed',
    'admin.crawl.stop_confirm': 'Stop crawl?',
    'admin.crawl.stop_description':
      'Progress will be discarded. All data is only saved at the end.',
    'admin.crawl.stop_cancel': 'Cancel',
    'admin.crawl.stop_confirm_button': 'Stop & Close',
    'admin.categories.title': 'Categories',
    'admin.categories.searching': 'Searching...',
    'admin.categories.results_crawled': 'web results crawled',
    'admin.categories.parsed': 'legislations parsed',
    'admin.thinking.title': 'Thinking',
    'admin.thinking.waiting': 'Waiting for Claude to think...',
    'admin.thinking.tokens': 'Tokens:',
    'admin.output.title': 'Claude Output',
    'admin.output.waiting': 'Waiting for Claude output...',
    'admin.legislation_panel.loading': 'Loading...',
    'admin.legislation_panel.empty': 'No legislations',
    'admin.category.federal_laws': 'Federal Laws',
    'admin.category.federal_laws.description': 'Constitutional & main laws',
    'admin.category.regulations': 'Regulations',
    'admin.category.regulations.description': 'Official procedures',
    'admin.category.consular': 'Consular Rules',
    'admin.category.consular.description': 'Visa & embassies',
    'admin.category.jurisdictional': 'Jurisdictional',
    'admin.category.jurisdictional.description': 'Regional rules',
    'admin.category.complementary': 'Health & Complementary',
    'admin.category.complementary.description': 'Health requirements',
    'admin.category.auxiliary': 'Auxiliary',
    'admin.category.auxiliary.description': 'Statistics & quotas',
    'admin.crawl.tokens': 'tokens',
    'admin.crawl.parsing': 'parsing',
    'admin.crawl.found': 'found',
    'admin.thinking.adaptive': 'Adaptive',
    'admin.thinking.high_effort': 'High effort',
    'admin.crawl.more': 'more',
    'admin.extraction.progress': 'extracted',
    'admin.extraction.processing': 'extracting...',
    'admin.extraction.failed': 'failed',
    'legislation.source': 'Source',
    'legislation.deprecated': 'Deprecated',
    'usage.tokens_short': 'tokens',
    'countries.us': 'United States',
    'countries.br': 'Brazil',
    'countries.de': 'Germany',
    'countries.fr': 'France',
    'countries.gb': 'United Kingdom',
    'countries.ca': 'Canada',
    'countries.au': 'Australia',
    'countries.jp': 'Japan',
    'countries.cn': 'China',
    'countries.in': 'India',
    'countries.mx': 'Mexico',
    'countries.es': 'Spain',
    'countries.it': 'Italy',
    'countries.nl': 'Netherlands',
    'countries.se': 'Sweden',
    'countries.ch': 'Switzerland',
    'countries.at': 'Austria',
    'countries.be': 'Belgium',
    'countries.gr': 'Greece',
    'countries.pt': 'Portugal',
    'countries.nz': 'New Zealand',
    'countries.sg': 'Singapore',
    'countries.hk': 'Hong Kong',
    'countries.kr': 'South Korea',
    'countries.th': 'Thailand',
    'countries.ph': 'Philippines',
    'countries.my': 'Malaysia',
    'countries.id': 'Indonesia',
    'countries.vn': 'Vietnam',
    'countries.ar': 'Argentina',
    'countries.cl': 'Chile',
    'countries.co': 'Colombia',
    'countries.pe': 'Peru',
    'countries.za': 'South Africa',
    'countries.eg': 'Egypt',
    'countries.ng': 'Nigeria',
    'countries.ke': 'Kenya',
    'countries.ae': 'United Arab Emirates',
    'countries.sa': 'Saudi Arabia',
    'countries.il': 'Israel',
    'countries.tr': 'Turkey',
    'countries.ru': 'Russia',
    'countries.ua': 'Ukraine',
    'countries.pl': 'Poland',
    'countries.cz': 'Czech Republic',
    'countries.hu': 'Hungary',
    'countries.ro': 'Romania',
    'countries.bg': 'Bulgaria',
    'countries.hr': 'Croatia',
    'countries.ie': 'Ireland',
    'countries.dk': 'Denmark',
    'countries.fi': 'Finland',
    'countries.no': 'Norway',
    'countries.is': 'Iceland',
    'countries.lv': 'Latvia',
    'countries.lt': 'Lithuania',
    'countries.ee': 'Estonia',
    'countries.sk': 'Slovakia',
    'countries.si': 'Slovenia',
    'countries.mt': 'Malta',
    'countries.cy': 'Cyprus',
    'countries.lu': 'Luxembourg',
    'countries.kz': 'Kazakhstan',
    'countries.ge': 'Georgia',
    'countries.az': 'Azerbaijan',
    'countries.am': 'Armenia',
    'countries.pk': 'Pakistan',
    'countries.bd': 'Bangladesh',
    'countries.lk': 'Sri Lanka',
    'countries.np': 'Nepal',
    'countries.kh': 'Cambodia',
    'countries.la': 'Laos',
    'countries.mm': 'Myanmar',
    'countries.tw': 'Taiwan',
    'countries.mz': 'Mozambique',
    'countries.tz': 'Tanzania',
    'countries.ug': 'Uganda',
    'countries.gh': 'Ghana',
    'countries.sn': 'Senegal',
    'countries.ci': "Côte d'Ivoire",
    'countries.tn': 'Tunisia',
    'countries.dz': 'Algeria',
    'countries.ma': 'Morocco',
    'countries.jo': 'Jordan',
    'countries.lb': 'Lebanon',
    'countries.kw': 'Kuwait',
    'countries.qa': 'Qatar',
    'countries.bh': 'Bahrain',
    'countries.om': 'Oman',
    'countries.ye': 'Yemen',
    'countries.ir': 'Iran',
    'countries.af': 'Afghanistan',
    'countries.iq': 'Iraq',
    'countries.sy': 'Syria',
    'countries.ve': 'Venezuela',
    'countries.ec': 'Ecuador',
    'countries.bo': 'Bolivia',
    'countries.py': 'Paraguay',
    'countries.uy': 'Uruguay',
    'countries.cr': 'Costa Rica',
    'countries.pa': 'Panama',
    'countries.do': 'Dominican Republic',
    'countries.cu': 'Cuba',
    'countries.jm': 'Jamaica',
    'countries.tt': 'Trinidad and Tobago',
    'countries.bb': 'Barbados',
    'countries.gy': 'Guyana',
    'countries.sr': 'Suriname',
    'countries.bz': 'Belize',
    'countries.sv': 'El Salvador',
    'countries.gt': 'Guatemala',
    'countries.hn': 'Honduras',
    'countries.ni': 'Nicaragua',
    'countries.fj': 'Fiji',
    'theme.label': 'Theme',
    'theme.mood.clean': 'Clean',
    'theme.mood.tech': 'Tech',
    'theme.mood.warm': 'Warm',
    'theme.mood.bold': 'Bold',
    'theme.midnight': 'Midnight',
    'theme.slate': 'Slate',
    'theme.slate_rose': 'Slate Rose',
    'theme.slate_emerald': 'Slate Emerald',
    'theme.slate_gold': 'Slate Gold',
    'theme.obsidian': 'Obsidian',
    'theme.aurora': 'Aurora',
    'theme.nebula': 'Nebula',
    'theme.neon': 'Neon',
    'theme.ember': 'Ember',
    'theme.sage': 'Sage',
    'theme.copper': 'Copper',
    'theme.cosmos': 'Cosmos',
    'theme.arctic': 'Arctic',
    'theme.horizon': 'Horizon',
    'nav.design': 'Design',
    'design.title': 'Design System',
    'design.subtitle': 'Visual reference of components with the active theme',
    'design.section.palette': 'Color Palette',
    'design.section.typography': 'Typography',
    'design.section.buttons': 'Buttons',
    'design.section.inputs': 'Form Inputs',
    'design.section.cards': 'Cards',
    'design.section.status': 'Status Indicators',
    'design.section.glass': 'Glass Panel',
    'design.section.expandable': 'Expandable Sections',
    'design.section.icon_buttons': 'Icon Buttons',
    'design.section.section_header': 'Section Header',
    'design.section.agents': 'Agent Cards',
    'design.section.thinking': 'Thinking Cards',
    'design.section.tools': 'Tool Call Cards',
    'design.section.usage': 'Usage Badge',
    'design.section.animations': 'Animations',
  },
  ar: {
    'app.title': 'FreePath',
    'nav.chat': 'محادثة',
    'nav.admin': 'إدارة',
    'nav.menu': 'القائمة',
    'nav.logo.alt': 'شعار FreePath',
    'resize.tooltip': 'اسحب لتغيير الحجم',
    'sidebar.reconfigure': 'إعادة تهيئة',
    'sidebar.reconfigure.tooltip': 'إعادة تهيئة البيانات',
    'sidebar.expand': 'توسيع',
    'sidebar.collapse': 'طي',
    'sidebar.language': 'اللغة',
    'chat.empty': 'أرسل رسالة للبدء.',
    'chat.placeholder': 'اكتب رسالتك...',
    'chat.stop': 'إيقاف (Esc)',
    'chat.send': 'إرسال',
    'chat.processing': 'جارٍ المعالجة...',
    'chat.copy': 'نسخ',
    'chat.copied': 'تم النسخ!',
    'chat.interrupted': '*[تم مقاطعة الرد]*',
    'chat.faq.visaOptions': 'خيارات التأشيرة',
    'chat.faq.visaOptions.prompt': 'أود معرفة خيارات التأشيرة المتاحة لنوع هجرتي.',
    'chat.faq.requiredDocs': 'المستندات المطلوبة',
    'chat.faq.requiredDocs.prompt': 'ما هي المستندات المطلوبة لبدء عملية الهجرة؟',
    'chat.faq.timeline': 'المواعيد والتكاليف',
    'chat.faq.timeline.prompt': 'ما هي المواعيد المقدرة والتكاليف المتعلقة بعملية الهجرة؟',
    'chat.faq.gettingStarted': 'من أين أبدأ؟',
    'chat.faq.gettingStarted.prompt':
      'من أين أبدأ؟ ما هي الخطوة الأولى لبدء عملية الهجرة الخاصة بي؟',
    'greeting.intro': 'مرحباً! لقد فهمت أن لديك المعلومات التالية:',
    'greeting.nationalities': 'الجنسيات',
    'greeting.origin': 'بلد المنشأ',
    'greeting.destination': 'بلد الوجهة',
    'greeting.objective': 'الهدف',
    'greeting.closing': 'كيف يمكنني مساعدتك اليوم؟',
    'setup.description': 'أدخل بياناتك للحصول على إرشادات مخصصة حول عملية الهجرة الخاصة بك.',
    'setup.origin': 'بلد المنشأ',
    'setup.origin.placeholder': 'اختر بلد المنشأ',
    'setup.nationality': 'الجنسية',
    'setup.nationality.placeholder': 'مثال: مصري',
    'setup.destination': 'بلد الوجهة',
    'setup.destination.placeholder': 'اختر بلد الوجهة',
    'setup.visa': 'نوع التأشيرة / الهدف',
    'setup.visa.placeholder': 'مثال: عمل، دراسة، إقامة دائمة',
    'setup.additional': 'معلومات إضافية (اختياري)',
    'setup.additional.placeholder': 'سياق إضافي قد يساعد في الإجابات...',
    'setup.submit': 'بدء المحادثة',
    'setup.step.origin': 'بلد المنشأ',
    'setup.step.origin.description': 'من أي بلد ستغادر؟',
    'setup.step.nationalities': 'الجنسيات',
    'setup.step.nationalities.description': 'اذكر جميع جنسياتك الحالية',
    'setup.step.destination': 'بلد الوجهة',
    'setup.step.objective': 'الهدف',
    'setup.step.objective.description': 'ما هو سبب ذهابك إلى بلد الوجهة؟',
    'setup.objective.temporary_visit': 'زيارة مؤقتة',
    'setup.objective.education': 'تعليم',
    'setup.objective.work': 'عمل',
    'setup.objective.family_reunion': 'لم شمل الأسرة',
    'setup.objective.seek_protection': 'طلب حماية',
    'setup.objective.investments': 'استثمارات',
    'setup.objective.permanent_residence': 'إقامة دائمة',
    'setup.objective.other': 'أخرى',
    'setup.objective.other.placeholder': 'صف هدفك...',
    'setup.next': 'التالي',
    'setup.back': 'رجوع',
    'setup.cancel': 'إلغاء',
    'setup.start': 'بدء المحادثة',
    'setup.search.placeholder': 'ابحث عن بلد...',
    'chat.context.nationalities': 'الجنسيات:',
    'chat.context.from': 'من',
    'chat.context.to': 'إلى',
    'tool.search_visa_requirements': 'البحث عن متطلبات التأشيرة',
    'tool.check_processing_times': 'التحقق من أوقات المعالجة',
    'tool.analyze_pathways': 'تحليل مسارات الهجرة',
    'tool.check_eligibility': 'التحقق من الأهلية',
    'tool.list_required_documents': 'عرض المستندات المطلوبة',
    'tool.get_processing_statistics': 'الحصول على إحصائيات المعالجة',
    'tool.code_execution': 'تنفيذ الكود',
    'tool.get_legislation': 'جلب التشريعات',
    'usage.input': 'إدخال',
    'usage.output': 'إخراج',
    'usage.cached': 'مخزن مؤقتاً',
    'usage.cache_miss': 'غير مخزن',
    'sidebar.newChat': 'محادثة جديدة',
    'sidebar.deleteChat': 'حذف المحادثة',
    'globe.loading': 'جارٍ تحميل الكرة الأرضية...',
    'agent.analyze_pathways': 'محلل المسارات',
    'agent.check_eligibility': 'محلل الأهلية',
    'agent.list_required_documents': 'أخصائي التوثيق',
    'agent.get_processing_statistics': 'مدير الطلبات',
    'agent.unknown': 'وكيل',
    'agent.analyzing': 'جارٍ التحليل...',
    'agent.cancelled': 'تم الإلغاء',
    'thinking.active': 'جارٍ التفكير...',
    'thinking.done': 'اكتمل الاستدلال',
    'usage.label': 'رموز مستخدمة',
    'admin.header.title': 'إدارة التشريعات',
    'admin.header.description': 'إدارة تشريعات الدول',
    'admin.section.active': 'نشط',
    'admin.section.pending': 'قيد الانتظار',
    'admin.country_item.updated': 'تم التحديث',
    'admin.country_item.view_legislations': 'عرض التشريعات',
    'admin.country_item.refresh_legislation': 'تحديث التشريعات',
    'admin.units.doc': 'مستند',
    'admin.units.docs': 'مستندات',
    'admin.units.tokens': 'رموز',
    'admin.units.legislation': 'تشريع',
    'admin.units.legislations': 'تشريعات',
    'admin.crawl.loading': 'جارٍ التحميل...',
    'admin.crawl.error': 'خطأ في تحميل الدول',
    'admin.crawl.retry': 'إعادة المحاولة',
    'admin.crawl.no_countries': 'لا توجد دول متاحة',
    'admin.crawl.pause': 'إيقاف الزحف مؤقتاً',
    'admin.crawl.close': 'إغلاق',
    'admin.crawl.starting': 'بدء الزحف...',
    'admin.crawl.complete': '✓ اكتمل الزحف',
    'admin.crawl.documents_saved': 'مستندات محفوظة',
    'admin.crawl.stop_confirm': 'إيقاف الزحف؟',
    'admin.crawl.stop_description': 'سيتم تجاهل التقدم. يتم حفظ جميع البيانات في النهاية فقط.',
    'admin.crawl.stop_cancel': 'إلغاء',
    'admin.crawl.stop_confirm_button': 'إيقاف وإغلاق',
    'admin.categories.title': 'الفئات',
    'admin.categories.searching': 'جارٍ البحث...',
    'admin.categories.results_crawled': 'نتائج ويب تم زحفها',
    'admin.categories.parsed': 'تشريعات تم تحليلها',
    'admin.thinking.title': 'التفكير',
    'admin.thinking.waiting': 'في انتظار تفكير Claude...',
    'admin.thinking.tokens': 'رموز:',
    'admin.output.title': 'مخرجات Claude',
    'admin.output.waiting': 'في انتظار مخرجات Claude...',
    'admin.legislation_panel.loading': 'جارٍ التحميل...',
    'admin.legislation_panel.empty': 'لا توجد تشريعات',
    'admin.category.federal_laws': 'القوانين الاتحادية',
    'admin.category.federal_laws.description': 'القوانين الدستورية والرئيسية',
    'admin.category.regulations': 'اللوائح',
    'admin.category.regulations.description': 'الإجراءات الرسمية',
    'admin.category.consular': 'القواعد القنصلية',
    'admin.category.consular.description': 'التأشيرات والسفارات',
    'admin.category.jurisdictional': 'الاختصاص القضائي',
    'admin.category.jurisdictional.description': 'القواعد الإقليمية',
    'admin.category.complementary': 'الصحة والتكميلي',
    'admin.category.complementary.description': 'المتطلبات الصحية',
    'admin.category.auxiliary': 'مساعد',
    'admin.category.auxiliary.description': 'الإحصائيات والحصص',
    'admin.crawl.tokens': 'رموز',
    'admin.crawl.parsing': 'تحليل',
    'admin.crawl.found': 'تم العثور على',
    'admin.crawl.searching': 'جارٍ البحث',
    'admin.crawl.documents_indexed': 'مستندات مفهرسة',
    'admin.thinking.adaptive': 'تكيفي',
    'admin.thinking.high_effort': 'جهد عالٍ',
    'admin.crawl.more': 'المزيد',
    'admin.extraction.progress': 'تم الاستخراج',
    'admin.extraction.processing': 'جارٍ الاستخراج...',
    'admin.extraction.failed': 'فشل',
    'legislation.source': 'المصدر',
    'legislation.deprecated': 'متوقف',
    'usage.tokens_short': 'رموز',
    'countries.us': 'الولايات المتحدة',
    'countries.br': 'البرازيل',
    'countries.de': 'ألمانيا',
    'countries.fr': 'فرنسا',
    'countries.gb': 'المملكة المتحدة',
    'countries.ca': 'كندا',
    'countries.au': 'أستراليا',
    'countries.jp': 'اليابان',
    'countries.cn': 'الصين',
    'countries.in': 'الهند',
    'countries.mx': 'المكسيك',
    'countries.es': 'إسبانيا',
    'countries.it': 'إيطاليا',
    'countries.nl': 'هولندا',
    'countries.se': 'السويد',
    'countries.ch': 'سويسرا',
    'countries.at': 'النمسا',
    'countries.be': 'بلجيكا',
    'countries.gr': 'اليونان',
    'countries.pt': 'البرتغال',
    'countries.nz': 'نيوزيلندا',
    'countries.sg': 'سنغافورة',
    'countries.hk': 'هونغ كونغ',
    'countries.kr': 'كوريا الجنوبية',
    'countries.th': 'تايلاند',
    'countries.ph': 'الفلبين',
    'countries.my': 'ماليزيا',
    'countries.id': 'إندونيسيا',
    'countries.vn': 'فيتنام',
    'countries.ar': 'الأرجنتين',
    'countries.cl': 'تشيلي',
    'countries.co': 'كولومبيا',
    'countries.pe': 'بيرو',
    'countries.za': 'جنوب أفريقيا',
    'countries.eg': 'مصر',
    'countries.ng': 'نيجيريا',
    'countries.ke': 'كينيا',
    'countries.ae': 'الإمارات العربية المتحدة',
    'countries.sa': 'المملكة العربية السعودية',
    'countries.il': 'إسرائيل',
    'countries.tr': 'تركيا',
    'countries.ru': 'روسيا',
    'countries.ua': 'أوكرانيا',
    'countries.pl': 'بولندا',
    'countries.cz': 'جمهورية التشيك',
    'countries.hu': 'المجر',
    'countries.ro': 'رومانيا',
    'countries.bg': 'بلغاريا',
    'countries.hr': 'كرواتيا',
    'countries.ie': 'أيرلندا',
    'countries.dk': 'الدنمارك',
    'countries.fi': 'فنلندا',
    'countries.no': 'النرويج',
    'countries.is': 'آيسلندا',
    'countries.lv': 'لاتفيا',
    'countries.lt': 'ليتوانيا',
    'countries.ee': 'إستونيا',
    'countries.sk': 'سلوفاكيا',
    'countries.si': 'سلوفينيا',
    'countries.mt': 'مالطا',
    'countries.cy': 'قبرص',
    'countries.lu': 'لوكسمبورغ',
    'countries.kz': 'كازاخستان',
    'countries.ge': 'جورجيا',
    'countries.az': 'أذربيجان',
    'countries.am': 'أرمينيا',
    'countries.pk': 'باكستان',
    'countries.bd': 'بنغلاديش',
    'countries.lk': 'سريلانكا',
    'countries.np': 'نيبال',
    'countries.kh': 'كمبوديا',
    'countries.la': 'لاوس',
    'countries.mm': 'ميانمار',
    'countries.tw': 'تايوان',
    'countries.mz': 'موزمبيق',
    'countries.tz': 'تنزانيا',
    'countries.ug': 'أوغندا',
    'countries.gh': 'غانا',
    'countries.sn': 'السنغال',
    'countries.ci': 'ساحل العاج',
    'countries.tn': 'تونس',
    'countries.dz': 'الجزائر',
    'countries.ma': 'المغرب',
    'countries.jo': 'الأردن',
    'countries.lb': 'لبنان',
    'countries.kw': 'الكويت',
    'countries.qa': 'قطر',
    'countries.bh': 'البحرين',
    'countries.om': 'عُمان',
    'countries.ye': 'اليمن',
    'countries.ir': 'إيران',
    'countries.af': 'أفغانستان',
    'countries.iq': 'العراق',
    'countries.sy': 'سوريا',
    'countries.ve': 'فنزويلا',
    'countries.ec': 'الإكوادور',
    'countries.bo': 'بوليفيا',
    'countries.py': 'باراغواي',
    'countries.uy': 'الأوروغواي',
    'countries.cr': 'كوستاريكا',
    'countries.pa': 'بنما',
    'countries.do': 'جمهورية الدومينيكان',
    'countries.cu': 'كوبا',
    'countries.jm': 'جامايكا',
    'countries.tt': 'ترينيداد وتوباغو',
    'countries.bb': 'باربادوس',
    'countries.gy': 'غيانا',
    'countries.sr': 'سورينام',
    'countries.bz': 'بليز',
    'countries.sv': 'السلفادور',
    'countries.gt': 'غواتيمالا',
    'countries.hn': 'هندوراس',
    'countries.ni': 'نيكاراغوا',
    'countries.fj': 'فيجي',
    'theme.label': 'السمة',
    'theme.mood.clean': 'نظيف',
    'theme.mood.tech': 'تقني',
    'theme.mood.warm': 'دافئ',
    'theme.mood.bold': 'جريء',
    'theme.midnight': 'Midnight',
    'theme.slate': 'Slate',
    'theme.slate_rose': 'Slate Rose',
    'theme.slate_emerald': 'Slate Emerald',
    'theme.slate_gold': 'Slate Gold',
    'theme.obsidian': 'Obsidian',
    'theme.aurora': 'Aurora',
    'theme.nebula': 'Nebula',
    'theme.neon': 'Neon',
    'theme.ember': 'Ember',
    'theme.sage': 'Sage',
    'theme.copper': 'Copper',
    'theme.cosmos': 'Cosmos',
    'theme.arctic': 'Arctic',
    'theme.horizon': 'Horizon',
    'nav.design': 'التصميم',
    'design.title': 'نظام التصميم',
    'design.subtitle': 'مرجع بصري للمكونات مع السمة النشطة',
    'design.section.palette': 'لوحة الألوان',
    'design.section.typography': 'الطباعة',
    'design.section.buttons': 'الأزرار',
    'design.section.inputs': 'حقول الإدخال',
    'design.section.cards': 'البطاقات',
    'design.section.status': 'مؤشرات الحالة',
    'design.section.glass': 'لوحة زجاجية',
    'design.section.expandable': 'أقسام قابلة للتوسيع',
    'design.section.icon_buttons': 'أزرار الأيقونات',
    'design.section.section_header': 'عنوان القسم',
    'design.section.agents': 'بطاقات الوكلاء',
    'design.section.thinking': 'بطاقات التفكير',
    'design.section.tools': 'بطاقات استدعاء الأدوات',
    'design.section.usage': 'شارة الاستخدام',
    'design.section.animations': 'الرسوم المتحركة',
  },
};

const VALID_LOCALES: Locale[] = ['pt-BR', 'en', 'ar'];

function detectSystemLocale(): Locale {
  const languages = navigator.languages ?? [navigator.language];
  for (const lang of languages) {
    if (VALID_LOCALES.includes(lang as Locale)) return lang as Locale;
    const prefix = lang.split('-')[0];
    const match = VALID_LOCALES.find((l) => l.split('-')[0] === prefix);
    if (match) return match;
  }
  return 'en';
}

function loadLocale(): Locale {
  try {
    const stored = localStorage.getItem(STORAGE_KEY);
    if (VALID_LOCALES.includes(stored as Locale)) return stored as Locale;
  } catch {
    // ignore
  }
  return detectSystemLocale();
}

const I18nContext = createContext<I18nContextValue | null>(null);

export function I18nProvider({ children }: { children: ReactNode }) {
  const [locale, setLocaleState] = useState<Locale>(loadLocale);
  const direction = LOCALE_DIRECTION[locale];

  useEffect(() => {
    document.documentElement.lang = locale;
    document.documentElement.dir = direction;
  }, [locale, direction]);

  const setLocale = useCallback((newLocale: Locale) => {
    setLocaleState(newLocale);
    try {
      localStorage.setItem(STORAGE_KEY, newLocale);
    } catch {
      // ignore
    }
  }, []);

  const t = useCallback((key: string) => dictionaries[locale][key] ?? key, [locale]);

  return <I18nContext value={{ locale, direction, setLocale, t }}>{children}</I18nContext>;
}

export function useI18n() {
  const ctx = useContext(I18nContext);
  if (!ctx) throw new Error('useI18n must be used within I18nProvider');
  return ctx;
}

export function useDirection(): Direction {
  const { direction } = useI18n();
  return direction;
}
